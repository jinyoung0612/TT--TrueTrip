<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Yoga Studio Template">
    <meta name="keywords" content="Yoga, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TT-TrueTrip</title>

    <!-- Google Font -->
    <!--    <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900&display=swap" rel="stylesheet">-->

    <!--    &lt;!&ndash; Css Styles &ndash;&gt;-->
    <!--    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">-->
    <!--    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css">-->
    <!--    <link rel="stylesheet" href="css/flaticon.css" type="text/css">-->
    <!--    <link rel="stylesheet" href="css/nice-select.css" type="text/css">-->
    <!--    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css">-->
    <!--    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css">-->
    <!--    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css">-->
    <!--    <link rel="stylesheet" href="css/style.css" type="text/css">-->



    <!--    <link rel="stylesheet" type="text/css" href="slick/slick.css">-->
    <!--    <link rel="stylesheet" type="text/css" href="slick/slick-theme.css">-->
    <% include head_link.html%>
    <script src="slick/slick.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/jquery.slicknav.js"></script>

    <!--    favicon-->
    <!--    <link rel="icon" href="img/favicon-32x32.png">-->
    <!--    <script src="http://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="-->
    <!--            crossorigin="anonymous"></script>-->


    <style>
        * {
            box-sizing: border-box;
        }
        .filterlabel{
            color:black;
        }
        /*슬라이더 전체 크기*/
        .slider {
            width: 95%;
            margin: 10px auto;
            /*background: yellow;*/

        }

        /*chg. 각 슬라이드의 사이 간격*/
        .slick-slide {
            margin: 0px 4px;

        }

        /*슬라이드의 이미지 크기*/
        .slick-slide img {
            width: 100%;
            height: 100%;
            border: 2px solid #CACDD6;
        }

        /*화살표 색*/
        .slick-prev:before,
        .slick-next:before {
            color: black;
        }


        .slick-slide {
            transition: all ease-in-out .3s;
            opacity: 1;
        }

        .slick-active {
            opacity: 1;
        }

        .slick-current {
            opacity: 1;
        }

        .filter-left .location-filter {
            margin-bottom: 60px;
        }

        .filter-left .location-filter h3, .filter-left .category-filter h3 {
            margin-bottom: 32px;
            font-size:x-large;
            font-weight:bold;
            /*color:gray;*/
        }

        .filter-left .location-filter .location-option .lo-item input {
            visibility: hidden;
            position: absolute;
        }

        .filter-left .location-filter .location-option .lo-item label {
            color: #787878;
            font-size: 18px;
            line-height: 32px;
            letter-spacing: 0.2px;
            padding-left: 28px;
            position: relative;
            cursor: pointer;
        }

        .filter-left .location-filter .location-option .lo-item label.active:after {
            background: #FF5581;
            border-color: #FF5581;
        }

        .filter-left .location-filter .location-option .lo-item label:after {
            position: absolute;
            left: 0;
            top: 9px;
            width: 16px;
            height: 16px;
            border: 1px solid #CCCCCC;
            content: "";
        }

        .planners {
            width: 100%;
            height: 100%;
            min-height: 600px;
            /*background: blue;*/
            postion: absolute;
        }

        .planners .planner {
            width: 100%;
            height: 280px;
            background: #8e8e8e;
            background-color: rgba( 203, 193, 193, 0.25 );
            position: relative;
            margin-top: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
            /*border: 0.8px solid #787878;*/

        }

        .planners .planner .profile {
            width: 20%;
            height: 80%;
            /*background: red;*/
            border: solid black 1px;
            float: left;
            margin-left: 20px;
            margin-right: 3px;
            margin-top: 15px;
            margin-bottom: auto;
            text-align: center;
        }

        .planners .planner .profile .profile_img {
            height: 85%;
            width: 100%;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            /*background: blue;*/

        }


        .planners .planner .desc {
            width: 77%;
            height: 100%;
            margin: auto;
            /*background: green;*/
            /*background: green;*/
            float: right;
            padding-top:25px;

        }

        .yellowRating {
            color: #fff;
            background: #FF5581;
            font-size: 12px;
            font-weight: 700;
            /*display: inline-block;*/
            padding: 5px 15px;
            text-transform: uppercase;
            position: absolute;
            right: auto;
            border-top-left-radius: 5px;


        }


        .plannerRating {
            position: absolute;
            left: 11px;
            top: 14px;
            height: 55px;
            width: 55px;
            background: #FF5581;
            text-align: center;
            line-height: 55px;
            border-radius: 50%;
            color: #fff;
            font-size: 10px;
            font-weight: 900;
            letter-spacing: 0.2px;

        }

        .planners_IDs {
            display: inline-block;
            padding: 7px 20px;

            font-size: 18px;
            color: black;
            font-weight: 900;
            letter-spacing: 0.2px;

        }

        .mystar {
            height: 30%;
        !important;
            width: 30%;
        !important;
        }

        /*newest, oldest 오류수정*/
        .arrange-select .nice-select .current {
            display: initial;
        }


    </style>


    <script>


        jQuery(document).ready(function ($) {

            var contentString = ""
            var stringArr = new Array();
            var pagenum = 0;
            var contentnum=0;
            var temp_score = 0;
            var result_score = new Array();


            //fill body content
            function fillcontent(imagedata, idData, score) {
                contentString = " "
                stringArr = [];
                pagenum = 0;
                contentnum=0;

                for (var i = 0; i < idData.length; i++) {
                    console.log(idData.length+'idData.length');

                    //게시글이 없는 planner 건너뛰기
                    if (imagedata[i] == "none") {


                        if ((contentnum>0&&contentnum%4==0)||i == idData.length - 1 ) {
                            stringArr[pagenum] = contentString;
                            if(contentnum%4==0){console.log('incontentnum3 '+i);contentString = "";pagenum++; contentnum=0;}
                            continue;
                        }
                        console.log("in none"+i)
                        continue;
                    }
                    // console.log(i)
                    //fill the profile
                    contentString +=

                        "                        <div class=\"planner\" >\n" +
                        "                            <div class=\"profile\" style=\"border:none; cursor: pointer; \">\n" +
                        "                                <div class=\"profile_img\" >\n" +
                        "                                   <div class='yellowRating' style='width:70px; padding-left:0px;padding-right:0px;'><img class='mystar' src='img/mystar.PNG' >" + score[i] + "</div>" +
                        "                                    <img  style='height: 210px; width: 198px; border:1px solid #CACDD6;border-top-left-radius: 5px;border-top-right-radius: 5px;' src='" + idData[i].path + "'>\n" +

                        "                                 <div  class=\"profile_desc\" style=\"border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;border:1px solid #CACDD6; background: #F7F8FB;\n" +
                        "\tpadding-left: 16px;\n" +
                        "\tpadding-top: 5px;\n" +
                        "\tpadding-bottom: 5px;\n" +
                        "\tpadding-right: 15px;\" >\n" +
                        "                                    <span class='planners_names' style='font-weight:bold'>" + idData[i].name + "</span>\n" +
                        "                                    <span style='display:none' class='planners_IDs'>" + idData[i].id + "</span>\n" +
                        "                                </div>\n" +
                        "                                </div>\n" +

                        "                            </div>\n" +
                        "\n" +
                        "                            <div class=\"desc\">\n" +
                        "                                <div class=\"autoplay slider\">\n"
                    for (var j = 0; j < imagedata[i].length; j++) {
                        contentString +=
                            "                                    <div>" +
                            "                                        <img style='width:180px; height: 210px;border-radius: 5px;' src='" + imagedata[i][j].path + "'>" +
                            "                                    </div>"
                    }
                    contentString +=
                        "                                </div>\n" +
                        "                            </div>\n" +
                        "                        </div>"
                    contentnum++;
                    console.log("in "+i+"contentnum: "+ contentnum);
                    //한 page당 4개의 planner
                    if ((i>0 && contentnum%4==0)|| i == idData.length - 1) {
                        stringArr[pagenum] = contentString;
                        if(contentnum%4==0){console.log("dsffsfsfsf: "+i+"cdc:"+contentnum);contentString = "";pagenum++; contentnum=0;;}
                        console.log("in pagination :"+i)

                    }
                }
                $("#showhere").html(stringArr[0]);

            }//end of fill content


            function changefilter(location, category) {
                $(".filter-left .location-filter .location-option .lo-item label").removeClass('active');
                $(".filter-left .category-filter .category-option .co-item label").removeClass('active');
                $('#' + location).addClass('active')
                $('#' + category).addClass('active')

            }

            //page 넘기기
            $('.pagination-num a').click(function () {
                window.setTimeout(start_slick, 400);

                var pagenum_ = parseInt($(this).text());
                $('#showhere').html(stringArr[pagenum_ - 1]);


            });
            var imagepath;
            var location;
            var category;
            var idData;
            var path;


            //for slider
            function start_slick() {
                $(".regular").slick({
                    dots: false,
                    infinite: true,
                    slidesToShow: 3,
                    slidesToScroll: 3,

                });

                $('.autoplay').slick({
                    slidesToShow: 3,
                    slidesToScroll: 1,
                    autoplay: true,
                    autoplaySpeed: 2000,
                    pauseOnHover: true,

                });
            }

            // 딜레이 7후에 start_slick 실행.
            window.setTimeout(start_slick, 400);

            //post request for planner and image data
            var posting = $.post('/showplanner', {})

            //post done, get data


            posting.done(function (data) {
                imagepath = data.data//get image path
                idData = data.Iddata// get selected ID data
                category = data.category//get selected category data
                location = data.location//get selected location data
                temp_score = 0;
                result_score = [];
                console.log(imagepath)
                console.log(idData)
                console.log(category)
                console.log(location)
                //review check
                for (var i = 0; i < idData.length; i++) {


                    if (idData[i].reviews.length == 0) {
                        result_score.push('NEW')
                        continue;
                    }
                    for (var j = 0; j < idData[i].reviews.length; j++) {
                        temp_score += parseInt(idData[i].reviews[j].score)

                    }
                    result_score.push((temp_score / idData[i].reviews.length).toFixed(1))
                    temp_score=0;
                }
                changefilter(location, category)
                fillcontent(imagepath, idData, result_score)
                imagepath=[];

                //set the filter section as selected data


            })


            //when location filter and category filter is selected
            $('input[name="the"], input[name="thec"]').click(function () {

                window.setTimeout(start_slick, 500);



                //get the id of selected filter __location and category
                var loc = $(".filter-left .location-filter .location-option .lo-item .active").attr('id')
                var cat = $(".filter-left .category-filter .category-option .co-item .active").attr('id')


                //plannerlist page에서 maybe frommain will work
                var posting_filter = $.post('/frommain', {'location': loc, 'category': cat})
                posting_filter.done(function (data) {


                    if (data == '1') {
                        //time 설정 needed

                        var posting_filter_start = $.post('/showplanner', {})

                        posting_filter_start.done(function (data) {

                            imagepath = data.data//get image path
                            idData = data.Iddata// get selected ID data
                            category = data.category//get selected category data
                            location = data.location//get selected location data

                            temp_score = 0;
                            result_score = [];
                            for (var i = 0; i < idData.length; i++) {


                                if (idData[i].reviews.length == 0) {
                                    result_score.push('NEW')
                                    continue;
                                }
                                for (var j = 0; j < idData[i].reviews.length; j++) {
                                    temp_score += parseInt(idData[i].reviews[j].score)
                                    console.log(temp_score)
                                    console.log(i+'\n\n');
                                }
                                result_score.push((temp_score / idData[i].reviews.length).toFixed(1))
                                temp_score = 0;

                            }
                            console.log("result_score:"+result_score+"\n\n");

                            //fill body section with data
                            fillcontent(imagepath, idData, result_score)
                            imagepath=[];
                        })
                    } else if (data == '0') {
                        //content가 없을 경우
                        console.log('in elseif')
                        $('#showhere').html(' ')
                    }

                })
            })

            //profile clicked
            $(document).on('click', '.profile', function () {
                var temp = $(this).find('.planners_IDs').text()
                //해당 아이디의 planner page로 감
                window.location.href = '/post/' + temp;
            })
        })
    </script>

</head>

<!--header-->
<header class="header-section listings">
    <% if(isAuthenticated) { %>
        <% include header_af_login.ejs %>
    <% } else { %>
        <% include header_bf_login.html %>
    <% } %>
</header>

<body>
<!-- Page Preloder -->
<div id="preloder">
    <div class="loader"></div>
</div>


<div class="hero-listing set-bg" data-setbg="img/cats/bg.jpg" style="height: 200px;">
</div>


<!-- Header End -->


<!-- Filter Section Begin -->
<section class="filter-section spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="filter-left">
                    <div class="location-filter">
                        <h3 class="filterlabel">지역 필터</h3>
                        <div class="location-option">

                            <div class="lo-item">
                                <label id="모든지역" class="active"><input type="radio" name="the" value="모든지역">전체</label>
                            </div>
                            <div class="lo-item">
                                <label id="인계동"> <input type="radio" name="the" value="인계동">인계동</label>
                            </div>
                            <div class="lo-item">
                                <label id="행궁동"><input type="radio" name="the" value="행궁동">행궁동</label>
                            </div>
                            <div class="lo-item">
                                <label id="영통동"><input type="radio" name="the" value="영통동">영통동</label>
                            </div>
                            <div class="lo-item">
                                <label id="우만동"><input type="radio" name="the" value="우만동">우만동</label>
                            </div>
                            <div class="lo-item">
                                <label id="매탄동"><input type="radio" name="the" value="매탄동">매탄동</label>
                            </div>
                        </div>
                    </div>


                    <div class="category-filter">
                        <h3 class="filterlabel">카테고리 필터</h3>
                        <div class="category-option">
                            <div class="co-item">
                                <label class="active" id="모든카테고리"><input type="radio" name="thec"
                                                                         value="모든카테고리">전체</label>
                            </div>
                            <div class="co-item">
                                <label id="쇼핑"> <input type="radio" name="thec" value="쇼핑">쇼핑</label>
                            </div>
                            <div class="co-item">
                                <label id="카페"><input type="radio" name="thec" value="카페">카페</label>
                            </div>
                            <div class="co-item">
                                <label id="사진"><input type="radio" name="thec" value="사진">사진</label>
                            </div>
                            <div class="co-item">
                                <label id="음식"><input type="radio" name="thec" value="음식">음식</label>
                            </div>
                            <div class="co-item">
                                <label id="액티비티"><input type="radio" name="thec" value="액티비티">액티비티</label>
                            </div>
                            <div class="co-item">
                                <label id="유명명소"><input type="radio" name="thec" value="유명명소">유명명소</label>
                            </div>
                            <div class="co-item">
                                <label id="기타"><input type="radio" name="thec" value="기타">기타</label>
                            </div>

                        </div>
                    </div>


                    <!--                    <div class="rating-filter">-->
                    <!--                        <h3>Ratings</h3>-->
                    <!--                        <div class="rating-option">-->
                    <!--                            <div class="ro-item">-->
                    <!--                                <input type="radio">-->
                    <!--                                <label class="active">5.0</label>-->
                    <!--                                <div class="rating-pic">-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                            <div class="ro-item">-->
                    <!--                                <input type="radio">-->
                    <!--                                <label>4.0</label>-->
                    <!--                                <div class="rating-pic">-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                            <div class="ro-item">-->
                    <!--                                <input type="radio">-->
                    <!--                                <label>3.0</label>-->
                    <!--                                <div class="rating-pic">-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                            <div class="ro-item">-->
                    <!--                                <input type="radio">-->
                    <!--                                <label>2.0</label>-->
                    <!--                                <div class="rating-pic">-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                            <div class="ro-item">-->
                    <!--                                <input type="radio">-->
                    <!--                                <label>1.0</label>-->
                    <!--                                <div class="rating-pic">-->
                    <!--                                    <i class="fa fa-star"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                    <i class="fa fa-star grey-bg"></i>-->
                    <!--                                </div>-->
                    <!--                            </div>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                </div>
            </div>

            <div class="col-lg-9">
                <div class="row" id="parent">
                    <!--                    <div class="col-lg-12" style="height:5px;">-->
                    <!--                        <form action="#" class="arrange-select">-->
                    <!--                            <span>Arrange by</span>-->
                    <!--                            <select>-->
                    <!--                                <option>Newest</option>-->
                    <!--                                <option>Oldest</option>-->
                    <!--                            </select>-->
                    <!--                        </form>-->
                    <!--                    </div>-->

                    <!--                    planner list 들어가는 곳-->
                    <span class='animated infinite flipInX ' style="animation-duration:2s;position:inherit; font-weight: normal; color:#787878;font-size: x-large;"><i>"자신에게 맞는 플래너를 찾아보세요. "</i></span>
                    <hr width="100%">
                    <div id="showhere" class="planners">
                    </div>

                    <div class="col-lg-12 text-right">
                        <div class="pagination-num">
                            <a href="javascript:void (0)" value="1" id="check">01</a>
                            <a href="javascript:void (0)" value="2">02</a>
                            <a href="javascript:void (0)" value="3">03</a>
                            <a href="javascript:void (0)" value="4">04</a>
                            <a href="javascript:void (0)" value="5">05</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Filter Section End -->

<!-- App Section Begin -->
<section class="app-section spad listings">
    <div class="container">
        <div class="row">
            <div class="col-lg-5">
                <img src="img/phone.png" alt="">
            </div>
            <div class="col-lg-6 offset-lg-1">
                <div class="app-text">
                    <div class="section-title">
                        <h2>Get the App now!</h2>
                        <p>Explore some of the best places in the world</p>
                    </div>
                    <p>Morbi id dictum quam, ut commodo lorem. Donec bibendum, enim ut luctus dictum, nisl turpis
                        scelerisque sem, in dapibus neque odio eu sapien. Morbi ac aliquet erat. Sed dapibus, augue et
                        malesuada maximus.</p>
                    <ul>
                        <li><i class="fa fa-check"></i>Fusce urna quam, euismod sit amet mollis quis, vestibulum quis
                            veli
                        </li>
                        <li><i class="fa fa-check"></i>Vestibulum malesuada aliquet libero viverra cursus</li>
                        <li><i class="fa fa-check"></i>Urna quam, euismod sit amet mollis quis, vestibulum quis veli
                        </li>
                    </ul>
                    <a href="#"><img src="img/apple-store.jpg" alt=""></a>
                    <a href="#"><img src="img/google-store.jpg" alt=""></a>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- App Section End -->




<!-- Js Plugins -->
<script src="js/jquery-3.3.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.magnific-popup.min.js"></script>

<script src="js/owl.carousel.min.js"></script>
<script src="js/jquery.nice-select.min.js"></script>
<script src="js/mixitup.min.js"></script>
<script src="js/main.js"></script>
</body>

</html>